<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interaction Identification and Estimation using Data-Adaptive Stochastic Interventions • InterXshift</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Interaction Identification and Estimation using Data-Adaptive Stochastic Interventions">
<meta property="og:description" content="InterXshift">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">InterXshift</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/InterXshift-vignette.html">Interaction Identification and Estimation using Data-Adaptive Stochastic Interventions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="InterXshift-vignette_files/kePrint-0.0.1/kePrint.js"></script><link href="InterXshift-vignette_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Interaction Identification and Estimation using
Data-Adaptive Stochastic Interventions</h1>
                        <h4 data-toc-skip class="author">David
McCoy</h4>
            
            <h4 data-toc-skip class="date">2024-04-04</h4>
      
      
      <div class="hidden name"><code>InterXshift-vignette.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">InterXshift</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: usethis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tlverse.org/sl3" class="external-link">sl3</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">429153</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p>The motivation behind the package InterXshift is to address the
limitations of traditional statistical methods in environmental
epidemiology studies. Analysts are often interested in understanding the
joint impact of a mixed exposure, i.e. a vector of exposures, but the
most important exposures and exposure sets remain unknown. Traditional
methods make overly simplistic assumptions, such as linear and additive
relationships, and the resulting statistical quantities may not be
directly applicable to public policy decisions. More flexible methods
offer dose response relationships but do not result in an easily
interpretable estimate. Here, we utilize cross-validated targeted
learning with stochastic shift interventions to identify exposures in a
mixture that have the strongest positive and negative effect. We also
define interaction as a comparison of the expected outcome under joint
shift to additive shifts. With this definition we identify the top
synergistic and antagonistic relationships and provide efficient
estimates of stochastic shift interventions.</p>
</div>
<div class="section level2">
<h2 id="target-parameter">Target Parameter<a class="anchor" aria-label="anchor" href="#target-parameter"></a>
</h2>
<p>InterXshift uses data-adaptive machine learning methods to identify
the exposures and exposure sets that have the most synergy or
antagonism. This is defined based on our target parameter:</p>
<p>$$ <span class="math display">\[\begin{align}
    \Psi_{\text{IE}} = &amp;E[Y | A_i + \delta_i, A_j + \delta_j,
\mathbf{A}_{- i,j}, W] \nonumber \\
              &amp;- \big(E[Y | A_i + \delta_i, \mathbf{A}_{- i}, W] +
E[Y | A_j + \delta_j, \mathbf{A}_{- j}, W]\big) \nonumber \\
              &amp;+ E[Y]
  \end{align}\]</span></p>
<p>$$</p>
<p>Which measures the expected outcome under a shift of two exposures to
the sum of their individual impacts. The exposure sets with the largest
positive values have synergy meaning their joint impact is more than
additive. The exposure sets with the largest negative value have the
most antagonism.</p>
</div>
<div class="section level2">
<h2 id="g-computation-approximation">G-computation Approximation<a class="anchor" aria-label="anchor" href="#g-computation-approximation"></a>
</h2>
<p>To identify the most synergistic and antagonistic exposure sets we
employ a g-computation framework. We first construct a super learner, or
ensemble of machine learning algorithms. We then construct all two-way
combinations and for each combination calculate our interaction. We rank
these results and select the top positive and negative results which
represent synergy and antagonism.</p>
</div>
<div class="section level2">
<h2 id="sample-splitting">Sample Splitting<a class="anchor" aria-label="anchor" href="#sample-splitting"></a>
</h2>
<p>Because we don’t know which exposure sets to estimate our interaction
parameter on a priori, we need to split our data and in the training
fold find the exposure sets, using the above g-computation framework,
and in an estimation sample, efficiently estimate the interaction
parameter for these exposure sets so that we can get valid confidence
intervals for these data-adaptively identified interactions. This is
done using targeted learning.</p>
</div>
<div class="section level2">
<h2 id="targeted-learning">Targeted Learning<a class="anchor" aria-label="anchor" href="#targeted-learning"></a>
</h2>
<p>We use targeted minimum loss based estimation (TMLE) to debias our
initial outcome estimates given a shift in exposure such that the
resulting estimator is asymptotically unbiased and has the smallest
variance. This procedure involves constructing a least favorable
submodel which uses a ratio of conditional exposure densities under
shift and now shift as a covariate to debias the initial estimates. More
details of targeted learning for stochastic shifts are here <span class="citation">Dı́az and van der Laan (2012)</span></p>
</div>
<div class="section level2">
<h2 id="data-adaptive-delta">Data Adaptive Delta<a class="anchor" aria-label="anchor" href="#data-adaptive-delta"></a>
</h2>
<p>For each exposure, the user inputs a respective delta, for example
for exposures <span class="math inline">\(M1, M2, M3\)</span> the
analyst puts in the <code>deltas</code> vector</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deltas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M1"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"M2"</span> <span class="op">=</span> <span class="fl">2.3</span>, <span class="st">"M3"</span> <span class="op">=</span> <span class="fl">1.4</span><span class="op">)</span></span></code></pre></div>
<p>Which assigns a delta shift amount to each exposure. However, because
the user doesn’t know the underlying experimentation in the data, a
delta that is too big may result in positivity violations which leads to
bias and high variance of the estimator. That is, if the user asks for a
shift in exposure density that is very unlikely given the data. To solve
this, the analyst can also choose to set
<code>adaptive_delta = TRUE</code> which then makes the shift amount a
data adaptive parameter as well. The delta will be reduced until the max
of the ratio of densities for each exposure is less than or equal to
<code>hn_trunc_thresh</code>.</p>
</div>
<div class="section level2">
<h2 id="inputs-and-outputs">Inputs and Outputs<a class="anchor" aria-label="anchor" href="#inputs-and-outputs"></a>
</h2>
<p>InterXshift takes in covariates, exposures, an outcome, a list of
deltas to shift each exposure by, the estimator (tmle or one step)
number of folds for the CV procedure, parallelization parameters and if
the delta should be data-adaptive. Also the user defines top_n which is
the number of ranked synergistic, antagonistic and individual positive
and negative effects to extract from the mixed exposure.</p>
<p>The package then outputs K-fold specific results, the result found in
each fold, and the oracle result which is the parameter that is pooled
across all the folds. For example, we will get the fold specific synergy
results for the rank 1 and rank 2 exposure sets found to have the
highest expectation under joint shift compared to positive shift. The
pooled parameter is the oracle rank 1, meaning we do a pooled TMLE for
all the rank 1 findings across the folds. The same is true for the other
parameters.</p>
<p>We get pooled rank synergy, antagonism, positive and negative
effects. If the same exposure sets are used across the folds, the pooled
estimate is interpretable and has greater power compared to k-fold. If
not, the analyst must investigate the k-fold specific results and report
consistency of findings.</p>
</div>
<div class="section level2">
<h2 id="nhanes-data">NHANES Data<a class="anchor" aria-label="anchor" href="#nhanes-data"></a>
</h2>
<p>Here we will try and replicate the analysis by Gibson et. al.:</p>
<p><a href="https://ehjournal.biomedcentral.com/articles/10.1186/s12940-019-0515-1" class="external-link uri">https://ehjournal.biomedcentral.com/articles/10.1186/s12940-019-0515-1</a></p>
<p>and Mitro et. al, <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4858394/" class="external-link uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4858394/</a></p>
<p>Who used the NHANES 2001-2002 data to investigate 18 POP exposures on
telomere length.</p>
<p>Let’s first load the data and investigate the variables:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"NHANES_eurocim"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">exposures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LBX074LA"</span>, <span class="co"># PCB74 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX099LA"</span>, <span class="co"># PCB99 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX118LA"</span>, <span class="co"># PCB118 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX138LA"</span>, <span class="co"># PCB138 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX153LA"</span>, <span class="co"># PCB153 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX170LA"</span>, <span class="co"># PCB170 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX180LA"</span>, <span class="co"># PCB180 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX187LA"</span>, <span class="co"># PCB187 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBX194LA"</span>, <span class="co"># PCB194 Lipid Adj (ng/g)</span></span>
<span>               <span class="st">"LBXD03LA"</span>, <span class="co"># 1,2,3,6,7,8-hxcdd Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXD05LA"</span>, <span class="co"># 1,2,3,4,6,7,8-hpcdd Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXD07LA"</span>, <span class="co"># 1,2,3,4,6,7,8,9-ocdd Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXF03LA"</span>, <span class="co"># 2,3,4,7,8-pncdf Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXF04LA"</span>, <span class="co"># 1,2,3,4,7,8-hxcdf Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXF05LA"</span>, <span class="co"># 1,2,3,6,7,8-hxcdf Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXF08LA"</span>, <span class="co"># 1,2,3,4,6,7,8-hxcdf Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXHXCLA"</span>, <span class="co"># 3,3',4,4',5,5'-hxcb Lipid Adj (pg/g)</span></span>
<span>               <span class="st">"LBXPCBLA"</span><span class="op">)</span> <span class="co"># 3,3',4,4',5-pcnb Lipid Adj (pg/g)</span></span>
<span></span>
<span><span class="va">NHANES_eurocim</span> <span class="op">&lt;-</span> <span class="va">NHANES_eurocim</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">NHANES_eurocim</span><span class="op">[</span>, <span class="va">exposures</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="st">"TELOMEAN"</span></span>
<span></span>
<span><span class="va">covariates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LBXWBCSI"</span>, <span class="co"># White blood cell count (SI)</span></span>
<span>                <span class="st">"LBXLYPCT"</span>, <span class="co"># Lymphocyte percent (%)</span></span>
<span>                <span class="st">"LBXMOPCT"</span>, <span class="co"># Monocyte percent (%)</span></span>
<span>                <span class="st">"LBXEOPCT"</span>, <span class="co"># Eosinophils percent (%)</span></span>
<span>                <span class="st">"LBXBAPCT"</span>, <span class="co"># Basophils percent (%)</span></span>
<span>                <span class="st">"LBXNEPCT"</span>, <span class="co"># Segmented neutrophils percent (%)</span></span>
<span>                <span class="st">"male"</span>, <span class="co"># Sex</span></span>
<span>                <span class="st">"age_cent"</span>, <span class="co"># Age at Screening, centered</span></span>
<span>                <span class="st">"race_cat"</span>, <span class="co"># race</span></span>
<span>                <span class="st">"bmi_cat3"</span>, <span class="co"># Body Mass Index (kg/m**2)</span></span>
<span>                <span class="st">"ln_lbxcot"</span>, <span class="co"># Cotinine (ng/mL), log-transformed</span></span>
<span>                <span class="st">"edu_cat"</span><span class="op">)</span> <span class="co"># Education Level - Adults 20+</span></span></code></pre></div>
<p>To improve consistency in the region we find to be the maximizing
region, it is best to remove an exposure of highly correlated sets, we
do that here:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate the correlation matrix for the exposures</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">NHANES_eurocim</span><span class="op">[</span>, <span class="va">exposures</span><span class="op">]</span>, use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set a threshold for high correlation</span></span>
<span><span class="va">threshold</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span></span>
<span><span class="co"># Find pairs of highly correlated exposures</span></span>
<span><span class="va">highly_correlated_pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">threshold</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span>, arr.ind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Initiate a vector to keep track of exposures to remove</span></span>
<span><span class="va">exposures_to_remove</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Loop through the highly correlated pairs and decide which exposure to remove</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">pair</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">highly_correlated_pairs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">row</span> <span class="op">&lt;-</span> <span class="va">highly_correlated_pairs</span><span class="op">[</span><span class="va">pair</span>, <span class="st">"row"</span><span class="op">]</span></span>
<span>  <span class="va">col</span> <span class="op">&lt;-</span> <span class="va">highly_correlated_pairs</span><span class="op">[</span><span class="va">pair</span>, <span class="st">"col"</span><span class="op">]</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span><span class="op">[</span><span class="va">row</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">exposures_to_remove</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">exposures_to_remove</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">exposures_to_remove</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span><span class="op">[</span><span class="va">row</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Keep only uncorrelated exposures</span></span>
<span><span class="va">exposures_to_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">exposures</span>, <span class="va">exposures_to_remove</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-interxshift">Run InterXshift<a class="anchor" aria-label="anchor" href="#run-interxshift"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deltas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"LBX074LA"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"LBX099LA"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"LBXD03LA"</span> <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="st">"LBXD05LA"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"LBXF03LA"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"LBXF04LA"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"LBXF08LA"</span> <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  <span class="st">"LBXPCBLA"</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ptm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="va">NHANES_eurocim</span><span class="op">[</span>, <span class="va">covariates</span><span class="op">]</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">NHANES_eurocim</span><span class="op">[</span>, <span class="va">exposures_to_keep</span><span class="op">]</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">NHANES_eurocim</span><span class="op">$</span><span class="va">TELOMEAN</span></span>
<span></span>
<span><span class="va">NIEH_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InterXshift.html">InterXshift</a></span><span class="op">(</span></span>
<span>  w <span class="op">=</span> <span class="va">w</span>,</span>
<span>  a <span class="op">=</span> <span class="va">a</span>,</span>
<span>  y <span class="op">=</span> <span class="va">y</span>,</span>
<span>  deltas <span class="op">=</span> <span class="va">deltas</span>,</span>
<span>  n_folds <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  outcome_type <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parallel_type <span class="op">=</span> <span class="st">"multi_session"</span>,</span>
<span>  num_cores <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">seed</span>,</span>
<span>  adaptive_delta <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  top_n <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2325.8904     Pars:  0.15996 0.84004</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2325.8904     Pars:  0.15996 0.84004</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 3165.9080     Pars:  0.06705 0.93295</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 3165.9080     Pars:  0.06704 0.93296</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2857.9107     Pars:  0.07182 0.92818</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2857.9107     Pars:  0.07182 0.92818</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 3142.8885     Pars:  0.07186 0.92814</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 3142.8885     Pars:  0.07186 0.92814</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 3046.6289     Pars:  0.05747 0.94253</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 3046.6289     Pars:  0.05747 0.94253</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2137.4014     Pars:  0.11305 0.88695</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2137.4014     Pars:  0.11305 0.88695</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2150.0854     Pars:  0.34428 0.65572</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2150.0854     Pars:  0.34428 0.65572</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1964.8342     Pars:  0.37014 0.62986</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1964.8342     Pars:  0.37014 0.62986</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2324.8068     Pars:  0.39370 0.60630</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2324.8068     Pars:  0.39370 0.60630</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2760.7986     Pars:  0.57526 0.42474</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2760.7986     Pars:  0.57526 0.42474</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 3020.5766     Pars:  0.06794 0.93206</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 3020.5766     Pars:  0.06794 0.93206</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2778.2071     Pars:  0.67232 0.32768</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2778.2071     Pars:  0.67232 0.32768</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2568.9175     Pars:  0.17363 0.82637</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2568.9175     Pars:  0.17363 0.82637</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2274.4333     Pars:  0.20559 0.79441</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2274.4333     Pars:  0.20559 0.79441</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1602.7867     Pars:  0.07339 0.92661</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1602.7867     Pars:  0.07339 0.92661</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1228.9266     Pars:  0.04116 0.95884</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1228.9266     Pars:  0.04116 0.95884</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2308.6854     Pars:  0.29665 0.70335</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2308.6854     Pars:  0.29666 0.70334</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2947.1401     Pars:  0.06799 0.93201</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2947.1401     Pars:  0.06799 0.93201</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 3160.0092     Pars:  0.05740 0.94260</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 3160.0092     Pars:  0.05740 0.94260</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 3181.2465     Pars:  0.07397 0.92603</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 3181.2465     Pars:  0.07397 0.92603</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2905.0564     Pars:  0.04282 0.95718</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2905.0564     Pars:  0.04282 0.95718</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2224.6723     Pars:  0.08223 0.91777</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2224.6723     Pars:  0.08223 0.91777</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1629.4414     Pars:  0.05270 0.94730</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1629.4414     Pars:  0.05270 0.94730</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1980.5925     Pars:  0.31678 0.68322</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1980.5925     Pars:  0.31678 0.68322</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1631.8139     Pars:  0.09748 0.90252</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1631.8139     Pars:  0.09748 0.90252</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 3000.6226     Pars:  0.07931 0.92069</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 3000.6226     Pars:  0.07931 0.92069</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2868.0589     Pars:  0.06890 0.93110</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2868.0589     Pars:  0.06890 0.93110</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2914.1244     Pars:  0.04442 0.95558</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2914.1244     Pars:  0.04441 0.95559</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2829.1469     Pars:  0.04008 0.95992</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2829.1469     Pars:  0.04008 0.95992</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2401.3614     Pars:  0.53997 0.46003</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2401.3614     Pars:  0.53997 0.46003</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1261.2039     Pars:  0.05576 0.94424</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1261.2039     Pars:  0.05576 0.94424</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1357.7149     Pars:  0.07634 0.92366</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1357.7149     Pars:  0.07635 0.92365</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2282.2687     Pars:  0.22833 0.77167</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2282.2687     Pars:  0.22834 0.77166</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 3417.7656     Pars:  0.10997 0.89003</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 3417.7656     Pars:  0.10996 0.89004</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 3297.2807     Pars:  0.11893 0.88107</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 3297.2807     Pars:  0.11893 0.88107</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 3472.6381     Pars:  0.11233 0.88767</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 3472.6381     Pars:  0.11233 0.88767</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2853.6616     Pars:  0.04173 0.95827</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2853.6616     Pars:  0.04173 0.95827</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2335.5537     Pars:  0.27978 0.72022</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2335.5537     Pars:  0.27977 0.72023</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 1892.6252     Pars:  0.25059 0.74941</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 1892.6252     Pars:  0.25059 0.74941</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iter: 1 fn: 2036.2921     Pars:  0.58975 0.41025</span></span>
<span><span class="co">#&gt; Iter: 2 fn: 2036.2921     Pars:  0.58975 0.41025</span></span>
<span><span class="co">#&gt; solnp--&gt; Completed in 2 iterations</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/proc.time.html" class="external-link">proc.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">ptm</span></span>
<span><span class="co">#&gt;      user    system   elapsed </span></span>
<span><span class="co">#&gt;  1440.082   514.657 17518.854</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="investigating-results">Investigating Results<a class="anchor" aria-label="anchor" href="#investigating-results"></a>
</h2>
<p>One note is that for this example we will get more variability than
normal because we only run 3 fold CV due to computational time.</p>
<p>Let’s first look at the results for each fold:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NIEH_results</span><span class="op">$</span><span class="va">`Pos Shift Results by Rank`</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Top Positive Effects"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html" class="external-link">kable_classic</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>, html_font <span class="op">=</span> <span class="st">"Cambria"</span><span class="op">)</span></span></code></pre></div>
<table class="table kable_wrapper lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Top Positive Effects
</caption>
<tbody><tr>
<td>
<table class="table">
<thead><tr>
<th style="text-align:left;">
Condition
</th>
<th style="text-align:right;">
Psi
</th>
<th style="text-align:right;">
Variance
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
Lower CI
</th>
<th style="text-align:right;">
Upper CI
</th>
<th style="text-align:right;">
P-value
</th>
<th style="text-align:left;">
Fold
</th>
<th style="text-align:left;">
Type
</th>
<th style="text-align:left;">
Variables
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
Delta
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:right;">
0.0752633
</td>
<td style="text-align:right;">
0.0003448
</td>
<td style="text-align:right;">
0.0185682
</td>
<td style="text-align:right;">
0.0389
</td>
<td style="text-align:right;">
0.1117
</td>
<td style="text-align:right;">
0.0000505
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Indiv Shift
</td>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:right;">
-0.0063054
</td>
<td style="text-align:right;">
0.0001419
</td>
<td style="text-align:right;">
0.0119117
</td>
<td style="text-align:right;">
-0.0297
</td>
<td style="text-align:right;">
0.0170
</td>
<td style="text-align:right;">
0.5965658
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Indiv Shift
</td>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:right;">
0.0323595
</td>
<td style="text-align:right;">
0.0001715
</td>
<td style="text-align:right;">
0.0130950
</td>
<td style="text-align:right;">
0.0067
</td>
<td style="text-align:right;">
0.0580
</td>
<td style="text-align:right;">
0.0134685
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Indiv Shift
</td>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
LBXF04LA
</td>
<td style="text-align:right;">
0.0001602
</td>
<td style="text-align:right;">
0.0000959
</td>
<td style="text-align:right;">
0.0097917
</td>
<td style="text-align:right;">
-0.0190
</td>
<td style="text-align:right;">
0.0194
</td>
<td style="text-align:right;">
0.9869470
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
Indiv Shift
</td>
<td style="text-align:left;">
LBXF04LA
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:right;">
0.0110933
</td>
<td style="text-align:right;">
0.0001405
</td>
<td style="text-align:right;">
0.0118534
</td>
<td style="text-align:right;">
-0.0121
</td>
<td style="text-align:right;">
0.0343
</td>
<td style="text-align:right;">
0.3493350
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
Indiv Shift
</td>
<td style="text-align:left;">
LBXF03LA
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1
</td>
<td style="text-align:right;">
0.0002385
</td>
<td style="text-align:right;">
0.0000644
</td>
<td style="text-align:right;">
0.0080267
</td>
<td style="text-align:right;">
-0.0155
</td>
<td style="text-align:right;">
0.0160
</td>
<td style="text-align:right;">
0.9763000
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:left;">
Indiv Shift
</td>
<td style="text-align:left;">
Rank 1
</td>
<td style="text-align:right;">
1007
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</td>
</tr></tbody>
</table>
<p>Here we see LBXF03LA is found in all the folds for the top positive
effects. Estimates under Psi indicate the change in expected outcome
under a 1-unit intervention compared to the mean outcome under the
observed exposure distribution. Fold is the fold number estimates are
being made for and the last column is the pooled TMLE estimate for all
of our rank 1 estimates. Variance is estimated from the influence
function for stochastic shift interventions with subsequent standard
error and CI estimates.</p>
<p>N is the number of observations used in the calculation. In the
pooled results this should be equal to the total sample size. Here,
because we are interested in positive associations, if the associations
are significant we expect our Psi estimates to be positive, indicating a
shift is greater than the observed mean outcome.</p>
<p>Users here should look for inconsistencies in the exposure that is
found as the top positive effect. Inconsistencies indicate there is not
“strong signal” for this estimate and make the pooled rank 1 estimate
difficult to interpret.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NIEH_results</span><span class="op">$</span><span class="va">`Neg Shift Results by Rank`</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Top Negative Effects"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html" class="external-link">kable_classic</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>, html_font <span class="op">=</span> <span class="st">"Cambria"</span><span class="op">)</span></span></code></pre></div>
<table class="table kable_wrapper lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Top Negative Effects
</caption>
<tbody><tr>
<td>
<table class="table">
<thead><tr>
<th style="text-align:left;">
Condition
</th>
<th style="text-align:right;">
Psi
</th>
<th style="text-align:right;">
Variance
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
Lower CI
</th>
<th style="text-align:right;">
Upper CI
</th>
<th style="text-align:right;">
P-value
</th>
<th style="text-align:left;">
Fold
</th>
<th style="text-align:left;">
Type
</th>
<th style="text-align:left;">
Variables
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
Delta
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
LBXD05LA
</td>
<td style="text-align:right;">
0.0330499
</td>
<td style="text-align:right;">
0.0003561
</td>
<td style="text-align:right;">
0.0188693
</td>
<td style="text-align:right;">
-0.0039
</td>
<td style="text-align:right;">
0.0700
</td>
<td style="text-align:right;">
0.0798577
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Indiv Shift
</td>
<td style="text-align:left;">
LBXD05LA
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
LBXF08LA
</td>
<td style="text-align:right;">
-0.0427118
</td>
<td style="text-align:right;">
0.0001757
</td>
<td style="text-align:right;">
0.0132536
</td>
<td style="text-align:right;">
-0.0687
</td>
<td style="text-align:right;">
-0.0167
</td>
<td style="text-align:right;">
0.0012701
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Indiv Shift
</td>
<td style="text-align:left;">
LBXF08LA
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
LBXD03LA
</td>
<td style="text-align:right;">
0.0545727
</td>
<td style="text-align:right;">
0.0001489
</td>
<td style="text-align:right;">
0.0122022
</td>
<td style="text-align:right;">
0.0307
</td>
<td style="text-align:right;">
0.0785
</td>
<td style="text-align:right;">
0.0000077
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
Indiv Shift
</td>
<td style="text-align:left;">
LBXD03LA
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
LBXD03LA
</td>
<td style="text-align:right;">
0.2675288
</td>
<td style="text-align:right;">
0.0327868
</td>
<td style="text-align:right;">
0.1810712
</td>
<td style="text-align:right;">
-0.0874
</td>
<td style="text-align:right;">
0.6224
</td>
<td style="text-align:right;">
0.1395475
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
Indiv Shift
</td>
<td style="text-align:left;">
LBXD03LA
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
LBXD03LA
</td>
<td style="text-align:right;">
0.0439702
</td>
<td style="text-align:right;">
0.0002065
</td>
<td style="text-align:right;">
0.0143718
</td>
<td style="text-align:right;">
0.0158
</td>
<td style="text-align:right;">
0.0721
</td>
<td style="text-align:right;">
0.0022173
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
Indiv Shift
</td>
<td style="text-align:left;">
LBXD03LA
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1
</td>
<td style="text-align:right;">
0.0466035
</td>
<td style="text-align:right;">
0.0015466
</td>
<td style="text-align:right;">
0.0393273
</td>
<td style="text-align:right;">
-0.0305
</td>
<td style="text-align:right;">
0.1237
</td>
<td style="text-align:right;">
0.2360108
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:left;">
Indiv Shift
</td>
<td style="text-align:left;">
Rank 1
</td>
<td style="text-align:right;">
1007
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</td>
</tr></tbody>
</table>
<p>Here is the same type of table but for the top negative results.
Output is in the same format as above for the positive results. If the
Psi estimates are significant, we expect these effects to be negative.
Indicating the shift by 1 unit reduces the expected outcome compared to
the observed mean.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k_fold_synergy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">NIEH_results</span><span class="op">$</span><span class="va">`K Fold Synergy Results`</span><span class="op">)</span></span>
<span></span>
<span><span class="va">k_fold_synergy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Top Synergy Effects"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html" class="external-link">kable_classic</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>, html_font <span class="op">=</span> <span class="st">"Cambria"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Top Synergy Effects
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Rank
</th>
<th style="text-align:right;">
Psi
</th>
<th style="text-align:right;">
Variance
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
Lower CI
</th>
<th style="text-align:right;">
Upper CI
</th>
<th style="text-align:right;">
P-value
</th>
<th style="text-align:right;">
Fold
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
Delta Exposure 1
</th>
<th style="text-align:right;">
Delta Exposure 2
</th>
<th style="text-align:left;">
Type
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Rank 1.1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0739546
</td>
<td style="text-align:right;">
0.0026787
</td>
<td style="text-align:right;">
0.0517558
</td>
<td style="text-align:right;">
-0.1754
</td>
<td style="text-align:right;">
0.0275
</td>
<td style="text-align:right;">
0.7451230
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXD03LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0845122
</td>
<td style="text-align:right;">
0.0067418
</td>
<td style="text-align:right;">
0.0821086
</td>
<td style="text-align:right;">
-0.2454
</td>
<td style="text-align:right;">
0.0764
</td>
<td style="text-align:right;">
0.7680443
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXD05LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0101848
</td>
<td style="text-align:right;">
0.0000861
</td>
<td style="text-align:right;">
0.0092778
</td>
<td style="text-align:right;">
-0.0080
</td>
<td style="text-align:right;">
0.0284
</td>
<td style="text-align:right;">
0.9157903
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXD03LA-LBXD05LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.1686516
</td>
<td style="text-align:right;">
0.0092959
</td>
<td style="text-align:right;">
0.0964154
</td>
<td style="text-align:right;">
-0.0203
</td>
<td style="text-align:right;">
0.3576
</td>
<td style="text-align:right;">
0.5870288
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Interaction
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0540903
</td>
<td style="text-align:right;">
0.0001286
</td>
<td style="text-align:right;">
0.0113391
</td>
<td style="text-align:right;">
-0.0763
</td>
<td style="text-align:right;">
-0.0319
</td>
<td style="text-align:right;">
0.6114807
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXD03LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0391537
</td>
<td style="text-align:right;">
0.0001620
</td>
<td style="text-align:right;">
0.0127277
</td>
<td style="text-align:right;">
-0.0641
</td>
<td style="text-align:right;">
-0.0142
</td>
<td style="text-align:right;">
0.7285498
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXF08LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0323316
</td>
<td style="text-align:right;">
0.0001356
</td>
<td style="text-align:right;">
0.0116457
</td>
<td style="text-align:right;">
-0.0552
</td>
<td style="text-align:right;">
-0.0095
</td>
<td style="text-align:right;">
0.7644805
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXD03LA-LBXF08LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0609124
</td>
<td style="text-align:right;">
0.0001829
</td>
<td style="text-align:right;">
0.0135256
</td>
<td style="text-align:right;">
0.0344
</td>
<td style="text-align:right;">
0.0874
</td>
<td style="text-align:right;">
0.6004499
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Interaction
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.9
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.1252976
</td>
<td style="text-align:right;">
0.0123424
</td>
<td style="text-align:right;">
0.1110964
</td>
<td style="text-align:right;">
-0.3430
</td>
<td style="text-align:right;">
0.0924
</td>
<td style="text-align:right;">
0.7069781
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXD03LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.1355719
</td>
<td style="text-align:right;">
0.0180296
</td>
<td style="text-align:right;">
0.1342743
</td>
<td style="text-align:right;">
-0.3987
</td>
<td style="text-align:right;">
0.1276
</td>
<td style="text-align:right;">
0.7114006
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXD05LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.11
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0575058
</td>
<td style="text-align:right;">
0.0001232
</td>
<td style="text-align:right;">
0.0110977
</td>
<td style="text-align:right;">
0.0358
</td>
<td style="text-align:right;">
0.0793
</td>
<td style="text-align:right;">
0.5851505
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXD03LA-LBXD05LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.12
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.3183752
</td>
<td style="text-align:right;">
0.0305139
</td>
<td style="text-align:right;">
0.1746823
</td>
<td style="text-align:right;">
-0.0240
</td>
<td style="text-align:right;">
0.6607
</td>
<td style="text-align:right;">
0.4462068
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Interaction
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.13
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.2725149
</td>
<td style="text-align:right;">
0.0129081
</td>
<td style="text-align:right;">
0.1136138
</td>
<td style="text-align:right;">
0.0498
</td>
<td style="text-align:right;">
0.4952
</td>
<td style="text-align:right;">
0.4188084
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXD03LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.14
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0235456
</td>
<td style="text-align:right;">
0.0027286
</td>
<td style="text-align:right;">
0.0522361
</td>
<td style="text-align:right;">
-0.0788
</td>
<td style="text-align:right;">
0.1259
</td>
<td style="text-align:right;">
0.9179465
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXD05LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.15
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0284417
</td>
<td style="text-align:right;">
0.0022409
</td>
<td style="text-align:right;">
0.0473379
</td>
<td style="text-align:right;">
-0.0643
</td>
<td style="text-align:right;">
0.1212
</td>
<td style="text-align:right;">
0.8959947
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXD03LA-LBXD05LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.16
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.2676189
</td>
<td style="text-align:right;">
0.0186074
</td>
<td style="text-align:right;">
0.1364088
</td>
<td style="text-align:right;">
-0.5350
</td>
<td style="text-align:right;">
-0.0003
</td>
<td style="text-align:right;">
0.4687002
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Interaction
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.17
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0002447
</td>
<td style="text-align:right;">
0.0000535
</td>
<td style="text-align:right;">
0.0073114
</td>
<td style="text-align:right;">
-0.0146
</td>
<td style="text-align:right;">
0.0141
</td>
<td style="text-align:right;">
0.9977163
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXD03LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.18
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.1147112
</td>
<td style="text-align:right;">
0.0150682
</td>
<td style="text-align:right;">
0.1227528
</td>
<td style="text-align:right;">
-0.3553
</td>
<td style="text-align:right;">
0.1259
</td>
<td style="text-align:right;">
0.7433588
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXD05LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.19
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.1123677
</td>
<td style="text-align:right;">
0.0151475
</td>
<td style="text-align:right;">
0.1230752
</td>
<td style="text-align:right;">
-0.3536
</td>
<td style="text-align:right;">
0.1289
</td>
<td style="text-align:right;">
0.7487412
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXD03LA-LBXD05LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.20
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0025882
</td>
<td style="text-align:right;">
0.0302730
</td>
<td style="text-align:right;">
0.1739915
</td>
<td style="text-align:right;">
-0.3384
</td>
<td style="text-align:right;">
0.3436
</td>
<td style="text-align:right;">
0.9950493
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Interaction
</td>
</tr>
</tbody>
</table>
<p>These are now estimates for the top synergistic impact. The format of
the table is similar but now we have the Type column which indicates
which exposure the shift is for. Where one exposure is listed, that is a
univariate shift, where two is listed that is a joint shift and for
interaction this is comparing the expectation under joint shift to the
sum of the estimates under the univariate shifts.</p>
<p>If the interaction estimates are significant, we would expect the Psi
under interaction to be positive, indicating the joint shift is larger
than the sum of individual shifts. Variance estimates are similarly
derived from the influence function and delta method.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k_fold_antagonistic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">NIEH_results</span><span class="op">$</span><span class="va">`K Fold Antagonism Results`</span><span class="op">)</span></span>
<span></span>
<span><span class="va">k_fold_antagonistic</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Top Antagonistic Effects"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html" class="external-link">kable_classic</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>, html_font <span class="op">=</span> <span class="st">"Cambria"</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Top Antagonistic Effects
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Rank
</th>
<th style="text-align:right;">
Psi
</th>
<th style="text-align:right;">
Variance
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
Lower CI
</th>
<th style="text-align:right;">
Upper CI
</th>
<th style="text-align:right;">
P-value
</th>
<th style="text-align:right;">
Fold
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
Delta Exposure 1
</th>
<th style="text-align:right;">
Delta Exposure 2
</th>
<th style="text-align:left;">
Type
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Rank 1.1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0730422
</td>
<td style="text-align:right;">
0.0003387
</td>
<td style="text-align:right;">
0.0184047
</td>
<td style="text-align:right;">
0.0370
</td>
<td style="text-align:right;">
0.1091
</td>
<td style="text-align:right;">
0.5902975
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXF03LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0195870
</td>
<td style="text-align:right;">
0.0002035
</td>
<td style="text-align:right;">
0.0142650
</td>
<td style="text-align:right;">
-0.0084
</td>
<td style="text-align:right;">
0.0475
</td>
<td style="text-align:right;">
0.8697346
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXF04LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0065742
</td>
<td style="text-align:right;">
0.0002298
</td>
<td style="text-align:right;">
0.0151587
</td>
<td style="text-align:right;">
-0.0231
</td>
<td style="text-align:right;">
0.0363
</td>
<td style="text-align:right;">
0.9574162
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXF03LA-LBXF04LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0860550
</td>
<td style="text-align:right;">
0.0005404
</td>
<td style="text-align:right;">
0.0232468
</td>
<td style="text-align:right;">
-0.1316
</td>
<td style="text-align:right;">
-0.0405
</td>
<td style="text-align:right;">
0.5724749
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Interaction
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0102030
</td>
<td style="text-align:right;">
0.0001494
</td>
<td style="text-align:right;">
0.0122247
</td>
<td style="text-align:right;">
-0.0342
</td>
<td style="text-align:right;">
0.0138
</td>
<td style="text-align:right;">
0.9264757
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXF03LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0027759
</td>
<td style="text-align:right;">
0.0000643
</td>
<td style="text-align:right;">
0.0080176
</td>
<td style="text-align:right;">
-0.0129
</td>
<td style="text-align:right;">
0.0185
</td>
<td style="text-align:right;">
0.9752688
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXF04LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0155900
</td>
<td style="text-align:right;">
0.0002475
</td>
<td style="text-align:right;">
0.0157325
</td>
<td style="text-align:right;">
-0.0152
</td>
<td style="text-align:right;">
0.0464
</td>
<td style="text-align:right;">
0.9010833
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXF03LA-LBXF04LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0230170
</td>
<td style="text-align:right;">
0.0002578
</td>
<td style="text-align:right;">
0.0160567
</td>
<td style="text-align:right;">
-0.0085
</td>
<td style="text-align:right;">
0.0545
</td>
<td style="text-align:right;">
0.8558619
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
202
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Interaction
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.9
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0365694
</td>
<td style="text-align:right;">
0.0001913
</td>
<td style="text-align:right;">
0.0138329
</td>
<td style="text-align:right;">
0.0095
</td>
<td style="text-align:right;">
0.0637
</td>
<td style="text-align:right;">
0.7558547
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXF03LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0048776
</td>
<td style="text-align:right;">
0.0000917
</td>
<td style="text-align:right;">
0.0095742
</td>
<td style="text-align:right;">
-0.0139
</td>
<td style="text-align:right;">
0.0236
</td>
<td style="text-align:right;">
0.9602428
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXF04LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.11
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0029412
</td>
<td style="text-align:right;">
0.0002745
</td>
<td style="text-align:right;">
0.0165671
</td>
<td style="text-align:right;">
-0.0295
</td>
<td style="text-align:right;">
0.0354
</td>
<td style="text-align:right;">
0.9817695
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXF03LA-LBXF04LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.12
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0385058
</td>
<td style="text-align:right;">
0.0004507
</td>
<td style="text-align:right;">
0.0212296
</td>
<td style="text-align:right;">
-0.0801
</td>
<td style="text-align:right;">
0.0031
</td>
<td style="text-align:right;">
0.7915681
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Interaction
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.13
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0068210
</td>
<td style="text-align:right;">
0.0003370
</td>
<td style="text-align:right;">
0.0183576
</td>
<td style="text-align:right;">
-0.0428
</td>
<td style="text-align:right;">
0.0292
</td>
<td style="text-align:right;">
0.9598487
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXF03LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.14
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0117301
</td>
<td style="text-align:right;">
0.0001073
</td>
<td style="text-align:right;">
0.0103578
</td>
<td style="text-align:right;">
-0.0320
</td>
<td style="text-align:right;">
0.0086
</td>
<td style="text-align:right;">
0.9082412
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXF04LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.15
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0044069
</td>
<td style="text-align:right;">
0.0001401
</td>
<td style="text-align:right;">
0.0118372
</td>
<td style="text-align:right;">
-0.0188
</td>
<td style="text-align:right;">
0.0276
</td>
<td style="text-align:right;">
0.9676905
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXF03LA-LBXF04LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.16
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0229581
</td>
<td style="text-align:right;">
0.0003880
</td>
<td style="text-align:right;">
0.0196985
</td>
<td style="text-align:right;">
-0.0157
</td>
<td style="text-align:right;">
0.0616
</td>
<td style="text-align:right;">
0.8700651
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Interaction
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.17
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0122342
</td>
<td style="text-align:right;">
0.0001369
</td>
<td style="text-align:right;">
0.0117024
</td>
<td style="text-align:right;">
-0.0107
</td>
<td style="text-align:right;">
0.0352
</td>
<td style="text-align:right;">
0.9099565
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXF03LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.18
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0210257
</td>
<td style="text-align:right;">
0.0001546
</td>
<td style="text-align:right;">
0.0124327
</td>
<td style="text-align:right;">
-0.0454
</td>
<td style="text-align:right;">
0.0033
</td>
<td style="text-align:right;">
0.8504313
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXF04LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.19
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0102182
</td>
<td style="text-align:right;">
0.0001578
</td>
<td style="text-align:right;">
0.0125601
</td>
<td style="text-align:right;">
-0.0348
</td>
<td style="text-align:right;">
0.0144
</td>
<td style="text-align:right;">
0.9273530
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
LBXF03LA-LBXF04LA
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1.20
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-0.0014267
</td>
<td style="text-align:right;">
0.0002581
</td>
<td style="text-align:right;">
0.0160662
</td>
<td style="text-align:right;">
-0.0329
</td>
<td style="text-align:right;">
0.0301
</td>
<td style="text-align:right;">
0.9910192
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
201
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Interaction
</td>
</tr>
</tbody>
</table>
<p>This table is formatted in the same way as our synergistic results
where we compare joint shifts to individual shifts. Now however, if
interaction effects are significant, we expect the joint shift to be
less than the sum of individual shifts and therefore the interaction
effect should be negative.</p>
<p>Again, it is important to assess if the same exposures are found in
the synergist and antagonistic relationships. If they are, we can
interpret the pooled TMLE estimates, here we show our pooled estimates
for the antagonistic interaction:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">NIEH_results</span><span class="op">$</span><span class="va">`Pooled Antagonism Results by Rank`</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html" class="external-link">kbl</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Pooled Antagonistic Effects"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html" class="external-link">kable_classic</a></span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>, html_font <span class="op">=</span> <span class="st">"Cambria"</span><span class="op">)</span></span></code></pre></div>
<table class="table kable_wrapper lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Pooled Antagonistic Effects
</caption>
<tbody><tr>
<td>
<table class="table">
<thead><tr>
<th style="text-align:left;">
Rank
</th>
<th style="text-align:right;">
Psi
</th>
<th style="text-align:right;">
Variance
</th>
<th style="text-align:right;">
SE
</th>
<th style="text-align:right;">
Lower CI
</th>
<th style="text-align:right;">
Upper CI
</th>
<th style="text-align:right;">
P-value
</th>
<th style="text-align:left;">
Fold
</th>
<th style="text-align:right;">
N
</th>
<th style="text-align:right;">
Delta Exposure 1
</th>
<th style="text-align:right;">
Delta Exposure 2
</th>
<th style="text-align:left;">
Type
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Rank 1
</td>
<td style="text-align:right;">
-0.0029595
</td>
<td style="text-align:right;">
6.97e-05
</td>
<td style="text-align:right;">
0.0083486
</td>
<td style="text-align:right;">
-0.0193
</td>
<td style="text-align:right;">
0.0134
</td>
<td style="text-align:right;">
0.9741608
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:right;">
1007
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Var 1
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1
</td>
<td style="text-align:right;">
0.0009444
</td>
<td style="text-align:right;">
5.26e-05
</td>
<td style="text-align:right;">
0.0072535
</td>
<td style="text-align:right;">
-0.0133
</td>
<td style="text-align:right;">
0.0152
</td>
<td style="text-align:right;">
0.9911528
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:right;">
1007
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Var 2
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1
</td>
<td style="text-align:right;">
0.0194557
</td>
<td style="text-align:right;">
7.29e-05
</td>
<td style="text-align:right;">
0.0085384
</td>
<td style="text-align:right;">
0.0027
</td>
<td style="text-align:right;">
0.0362
</td>
<td style="text-align:right;">
0.8332369
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:right;">
1007
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Joint
</td>
</tr>
<tr>
<td style="text-align:left;">
Rank 1
</td>
<td style="text-align:right;">
0.0214709
</td>
<td style="text-align:right;">
9.63e-05
</td>
<td style="text-align:right;">
0.0098110
</td>
<td style="text-align:right;">
0.0022
</td>
<td style="text-align:right;">
0.0407
</td>
<td style="text-align:right;">
0.8283903
</td>
<td style="text-align:left;">
Pooled TMLE
</td>
<td style="text-align:right;">
1007
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Interaction
</td>
</tr>
</tbody>
</table>
</td>
</tr></tbody>
</table>
<p>This table is formatted similarly but now instead of having variable
names under Type we have Var 1, Var 2, Joint, Interaction. This is
because we are pooling estimates for the top antagonistic interaction
and the variables used in this interation may differ. If there is
consistency across all the folds, Var 1 corresponds to the first
variable that is shifted, Var 2 the second, Joint is the joint shift and
Interaction is the same comparison.</p>
<p>Again, if the interaction is significant and results are consistent
we would expect this estimate to be negative. By pooling, we are able to
leverage the full data which gives us more narrow confidence
intervals.</p>
</div>
<div class="section level2">
<h2 id="comparing-to-previous-findings">Comparing to Previous Findings<a class="anchor" aria-label="anchor" href="#comparing-to-previous-findings"></a>
</h2>
<p>Positive Association</p>
<p>For a shift of 1 unit in all exposures we found LBXF03LA
(2,3,4,7,8-pncdf Lipid Adj (pg/g)) to have the strongest positive
association. This matches the penalized regression results of Gibson et.
al. Similarly, this chemical had the second highest weight in WQS
regression. Using BKMR this chemical showed the highest positive
association in the dose-response plots.</p>
<p>Negative Association</p>
<p>We found LBXD03LA (1,2,3,6,7,8-hxcdd Lipid Adj (pg/g)) to have the
strongest negative association. Which is corroborated by the results
from Gibson et al., however there are many null/negative chemical
associations.</p>
<p>Synergy Results</p>
<p>LBXD03LA-LBXD05LA ((1,2,3,6,7,8-hxcdd - 1,2,3,4,6,7,8-hpcdd) had the
most consistency, 3 of 4 folds in this small example. From Gibson, no
interactions were found and the other methods did not assess for
interactions. None of the interventions were significant here with CI’s
spanning the range from antagonism to synergy for the interaction
effect. For the synergy effect we would expect the joint shift to be
larger than the additive effect.</p>
<p>Antagonistic Results</p>
<p>LBXF03LA (2,3,4,7,8-pncdf) and LBXF04LA (1,2,3,4,7,8-hxcdf) showed
the strongest antagonism and this relationship was found across all the
folds. This effect is not significant but what we would expect to see
for this result is that the joint shift is less than the additive
effect</p>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-diaz2012population" class="csl-entry">
Dı́az, Iván, and Mark J van der Laan. 2012. <span>“Population
Intervention Causal Effects Based on Stochastic Interventions.”</span>
<em>Biometrics</em> 68 (2): 541–49.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by David McCoy.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
